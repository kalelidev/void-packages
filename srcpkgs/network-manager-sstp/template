# Template file for 'network-manager-sstp'
pkgname=network-manager-sstp
version=1.3.2
revision=1
build_style=gnu-configure

configure_args="--prefix=/usr
	--libdir=/usr/lib
	--with-pppd-plugin-dir=/usr/lib/pppd/2.5.0
	--with-gnome
	--with-gtk4
	--disable-gtk-doc
	--disable-static"

hostmakedepends="pkg-config intltool autoconf automake libtool gettext-devel-tools glib-devel"

makedepends="NetworkManager-devel glib-devel gnutls-devel gtk+3-devel gtk4-devel libnma-devel libsecret-devel ppp-devel sstp-client-devel"

depends="NetworkManager sstp-client"

short_desc="NetworkManager VPN plugin for SSTP"
maintainer="kalelidev <gxiime@gmail.com>"
license="GPL-2.0-or-later"
homepage="https://gitlab.gnome.org/GNOME/network-manager-sstp"
distfiles="${homepage}/-/archive/release-${version}-1/network-manager-sstp-release-${version}-1.tar.bz2"
checksum="2c7b7914224b827add0312551c575540497920f2ca3ea01c11787d38f0ae4c62"

pre_configure() {
	NOCONFIGURE=1 ./autogen.sh
}

do_install() {
	make DESTDIR="${DESTDIR}" install
	find "${DESTDIR}" -name '*.la' -delete
	find "${DESTDIR}" -name '*.a' -delete
}

network-manager-sstp-gnome_package() {
	short_desc+=" - GNOME/GTK3/GTK4"
	depends="network-manager-sstp>=${version}_${revision} network-manager-applet>=1.26"
	pkg_install() {
		vmove "usr/lib/NetworkManager/*-editor.*"
		vmove usr/libexec/nm-sstp-auth-dialog
	}
}
